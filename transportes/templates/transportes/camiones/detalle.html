{% extends 'transportes/base_transportes.html' %}
{% load static %}

{% block title %}
    Detalle Camión {{ camion.patente }} - {{ block.super }}
{% endblock %}

{% block content %}
<div class="container-fluid px-4">
    <!-- Encabezado -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h1 class="h3 mb-0 text-gray-800">
                        <i class="fas fa-truck me-2"></i>
                        Camión {{ camion.patente }}
                    </h1>
                    <p class="text-muted mb-0">
                        Detalles del vehículo
                    </p>
                </div>
                <div class="d-flex gap-2">
                    <a href="{% url 'transportes:editar_camion' camion.pk %}" 
                       class="btn btn-warning">
                        <i class="fas fa-edit me-1"></i> Editar
                    </a>
                    <a href="{% url 'transportes:lista_camiones' %}" 
                       class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-1"></i> Volver
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Información del Camión -->
    <div class="row">
        <!-- Información Básica -->
        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">
                        <i class="fas fa-info-circle me-1"></i>
                        Información Básica
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <strong>Patente:</strong>
                        </div>
                        <div class="col-sm-8">
                            <span class="badge bg-primary fs-6">{{ camion.patente }}</span>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <strong>Cuenta Asociada:</strong>
                        </div>
                        <div class="col-sm-8">
                            <div>
                                <strong>{{ camion.cuenta_asociada.nombre }}</strong><br>
                                <small class="text-muted">{{ camion.cuenta_asociada.documento }}</small>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <strong>Estado:</strong>
                        </div>
                        <div class="col-sm-8">
                            {% if camion.activo %}
                                <span class="badge bg-success">Activo</span>
                            {% else %}
                                <span class="badge bg-danger">Inactivo</span>
                            {% endif %}
                        </div>
                    </div>

                    {% if camion.observaciones %}
                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <strong>Observaciones:</strong>
                        </div>
                        <div class="col-sm-8">
                            <p class="mb-0">{{ camion.observaciones }}</p>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Acoplados y Capacidades -->
        <div class="col-md-6 mb-4">
            <div class="card shadow">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">
                        <i class="fas fa-trailer me-1"></i>
                        Acoplados y Capacidades
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <strong>Acoplados:</strong>
                        </div>
                        <div class="col-sm-8">
                            {% if camion.acoplado_1 or camion.acoplado_2 %}
                                <div class="d-flex flex-column gap-1">
                                    {% if camion.acoplado_1 %}
                                        <span class="badge bg-info">{{ camion.acoplado_1 }}</span>
                                    {% endif %}
                                    {% if camion.acoplado_2 %}
                                        <span class="badge bg-info">{{ camion.acoplado_2 }}</span>
                                    {% endif %}
                                </div>
                            {% else %}
                                <span class="text-muted">Sin acoplados</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <strong>Capacidad de Carga:</strong>
                        </div>
                        <div class="col-sm-8">
                            {% if camion.capacidad_carga %}
                                <span class="fw-bold">{{ camion.capacidad_carga }} toneladas</span>
                            {% else %}
                                <span class="text-muted">No especificada</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <strong>Tara:</strong>
                        </div>
                        <div class="col-sm-8">
                            {% if camion.tara %}
                                <span class="fw-bold">{{ camion.tara }} toneladas</span>
                            {% else %}
                                <span class="text-muted">No especificada</span>
                            {% endif %}
                        </div>
                    </div>

                    {% if camion.capacidad_carga and camion.tara %}
                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <strong>Peso Bruto Total:</strong>
                        </div>
                        <div class="col-sm-8">
                            {% widthratio camion.capacidad_carga 1 1 as carga %}
                            {% widthratio camion.tara 1 1 as tara_val %}
                            <span class="fw-bold text-success">{{ carga|add:tara_val }} toneladas</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Documentación -->
    <div class="row">
        <div class="col-12 mb-4">
            <div class="card shadow">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">
                        <i class="fas fa-file-alt me-1"></i>
                        Documentación
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="text-center">
                                <div class="mb-2">
                                    {% if camion.vtv_vencida %}
                                        <i class="fas fa-times-circle fa-3x text-danger"></i>
                                    {% else %}
                                        <i class="fas fa-check-circle fa-3x text-success"></i>
                                    {% endif %}
                                </div>
                                <h6>VTV</h6>
                                {% if camion.fecha_vencimiento_vtv %}
                                    <p class="mb-0">
                                        <small>
                                            Vence: {{ camion.fecha_vencimiento_vtv|date:"d/m/Y" }}
                                        </small>
                                    </p>
                                    {% if camion.vtv_vencida %}
                                        <span class="badge bg-danger">Vencida</span>
                                    {% else %}
                                        <span class="badge bg-success">Vigente</span>
                                    {% endif %}
                                {% else %}
                                    <span class="badge bg-secondary">Sin fecha</span>
                                {% endif %}
                            </div>
                        </div>

                        <div class="col-md-4 mb-3">
                            <div class="text-center">
                                <div class="mb-2">
                                    {% if camion.seguro_vencido %}
                                        <i class="fas fa-times-circle fa-3x text-danger"></i>
                                    {% else %}
                                        <i class="fas fa-check-circle fa-3x text-success"></i>
                                    {% endif %}
                                </div>
                                <h6>Seguro</h6>
                                {% if camion.fecha_vencimiento_seguro %}
                                    <p class="mb-0">
                                        <small>
                                            Vence: {{ camion.fecha_vencimiento_seguro|date:"d/m/Y" }}
                                        </small>
                                    </p>
                                    {% if camion.seguro_vencido %}
                                        <span class="badge bg-danger">Vencido</span>
                                    {% else %}
                                        <span class="badge bg-success">Vigente</span>
                                    {% endif %}
                                {% else %}
                                    <span class="badge bg-secondary">Sin fecha</span>
                                {% endif %}
                            </div>
                        </div>

                        <div class="col-md-4 mb-3">
                            <div class="text-center">
                                <div class="mb-2">
                                    <i class="fas fa-shield-alt fa-3x text-info"></i>
                                </div>
                                <h6>Póliza de Seguro</h6>
                                {% if camion.numero_poliza %}
                                    <p class="mb-0">
                                        <small>Nº {{ camion.numero_poliza }}</small>
                                    </p>
                                    <span class="badge bg-info">Registrada</span>
                                {% else %}
                                    <span class="badge bg-secondary">Sin póliza</span>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Historial de Viajes (si existe) -->
    <div class="row">
        <div class="col-12 mb-4">
            <div class="card shadow">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <h6 class="m-0 font-weight-bold text-primary">
                        <i class="fas fa-route me-1"></i>
                        Viajes Recientes
                    </h6>
                    <a href="#" class="btn btn-sm btn-outline-primary">
                        <i class="fas fa-plus me-1"></i> Nuevo Viaje
                    </a>
                </div>
                <div class="card-body">
                    <div class="text-center text-muted py-4">
                        <i class="fas fa-road fa-2x mb-3"></i>
                        <p class="mb-0">Funcionalidad de viajes disponible próximamente</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Información del Sistema -->
    <div class="row">
        <div class="col-12">
            <div class="card shadow">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-secondary">
                        <i class="fas fa-info me-1"></i>
                        Información del Sistema
                    </h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <small class="text-muted">
                                <strong>Creado:</strong> {{ camion.fecha_alta|date:"d/m/Y H:i" }}
                            </small>
                        </div>
                        <div class="col-md-6">
                            <small class="text-muted">
                                <strong>Última modificación:</strong> {{ camion.fecha_modificacion|date:"d/m/Y H:i" }}
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // Inicializar tooltips
    $('[data-bs-toggle="tooltip"]').tooltip();
    
    // Efecto hover en las tarjetas
    $('.card').hover(
        function() {
            $(this).addClass('shadow-lg');
        },
        function() {
            $(this).removeClass('shadow-lg');
        }
    );
});
</script>
{% endblock %}